<div class="container mt-4" *ngIf="order && !loading">
  <div class="receipt-container">
    <!-- Receipt Header -->
    <div class="receipt-header text-center mb-4">
      <h2 class="text-success">
        <i class="fas fa-check-circle me-2"></i>
        Payment Successful!
      </h2>
      <p class="text-muted">Thank you for your purchase. Here's your receipt:</p>
    </div>

    <!-- Receipt Content -->
    <div class="card receipt-card">
      <div class="card-header bg-amazon text-white">
        <div class="row">
          <div class="col-md-6">
            <h4 class="mb-0">ShopEasy</h4>
            <small>Order Receipt</small>
          </div>
          <div class="col-md-6 text-end">
            <h5 class="mb-0">Receipt #{{order.id}}</h5>
            <small>{{order.orderDate | date:'medium'}}</small>
          </div>
        </div>
      </div>
      
      <div class="card-body">
        <!-- Customer Information -->
        <div class="row mb-4">
          <div class="col-md-6">
            <h6>Bill To:</h6>
            <p class="mb-1"><strong>{{order.user.username}}</strong></p>
            <p class="mb-1">{{order.user.email || 'N/A'}}</p>
          </div>
          <div class="col-md-6 text-end">
            <h6>Payment Information:</h6>
            <p class="mb-1" *ngIf="payment">
              <span class="badge bg-success">{{payment.status}}</span>
            </p>
            <p class="mb-1" *ngIf="payment">Payment ID: {{payment.razorpayPaymentId}}</p>
          </div>
        </div>

        <!-- Order Items -->
        <div class="table-responsive mb-4">
          <table class="table table-bordered">
            <thead class="table-light">
              <tr>
                <th>Image</th>
                <th>Product</th>
                <th>Price</th>
                <th>Quantity</th>
                <th>Total</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of order.orderItems">
                <td>
                  <img [src]="getProductImage(item.product)" [alt]="item.product.name" 
                       style="width: 50px; height: 50px; object-fit: cover;" 
                       class="rounded" (error)="onImageError($event)">
                </td>
                <td>
                  <strong>{{item.product.name}}</strong>
                  <br>
                  <small class="text-muted">{{item.product.description | slice:0:50}}...</small>
                </td>
                <td>${{item.price}}</td>
                <td>{{item.quantity}}</td>
                <td>${{item.price * item.quantity}}</td>
              </tr>
            </tbody>
            <tfoot class="table-light">
              <tr>
                <td colspan="4" class="text-end"><strong>Total Amount:</strong></td>
                <td><strong>${{getTotal()}}</strong></td>
              </tr>
            </tfoot>
          </table>
        </div>

        <!-- Order Status -->
        <div class="row mb-4">
          <div class="col-md-6">
            <h6>Order Status:</h6>
            <span class="badge bg-info">{{order.status}}</span>
          </div>
          <div class="col-md-6 text-end">
            <h6>Estimated Delivery:</h6>
            <p class="mb-0">3-5 Business Days</p>
          </div>
        </div>

        <!-- Thank You Message -->
        <div class="text-center border-top pt-3">
          <p class="text-muted mb-0">Thank you for shopping with ShopEasy!</p>
          <small>For any queries, contact us at support&#64;shopeasy.com</small>
        </div>
      </div>
    </div>

    <!-- Action Buttons -->
    <div class="text-center mt-4 no-print">
      <button class="btn btn-amazon me-3" (click)="downloadReceipt()">
        <i class="fas fa-download me-2"></i>
        Download Receipt
      </button>
      <button class="btn btn-outline-amazon me-3" (click)="goToOrders()">
        <i class="fas fa-list me-2"></i>
        View All Orders
      </button>
      <button class="btn btn-outline-secondary" (click)="continueShopping()">
        <i class="fas fa-shopping-bag me-2"></i>
        Continue Shopping
      </button>
    </div>
  </div>
</div>

<!-- Loading State -->
<div class="container mt-5" *ngIf="loading">
  <div class="text-center">
    <div class="spinner-border text-amazon" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
    <p class="mt-3">Loading receipt...</p>
  </div>
</div>

<!-- Error State -->
<div class="container mt-5" *ngIf="error">
  <div class="alert alert-danger text-center">
    <i class="fas fa-exclamation-triangle fa-2x mb-3"></i>
    <h4>Receipt Not Found</h4>
    <p>{{error}}</p>
    <button class="btn btn-amazon" (click)="goToOrders()">View Orders</button>
  </div>
</div>